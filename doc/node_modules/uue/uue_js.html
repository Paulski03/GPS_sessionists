<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>uue.js - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../Gemfile.html">Gemfile</a>
  
    <li><a href="../../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../../README_md.html">README</a>
  
    <li><a href="../../Rakefile.html">Rakefile</a>
  
    <li><a href="../../app/assets/config/manifest_js.html">manifest.js</a>
  
    <li><a href="../../app/assets/javascripts/application_js.html">application.js</a>
  
    <li><a href="../../app/assets/javascripts/cable_js.html">cable.js</a>
  
    <li><a href="../../app/assets/javascripts/pages_coffee.html">pages.coffee</a>
  
    <li><a href="../../app/assets/stylesheets/application_css_scss.html">application.css.scss</a>
  
    <li><a href="../../app/assets/stylesheets/custom_css_scss.html">custom.css.scss</a>
  
    <li><a href="../../app/assets/stylesheets/pages_scss.html">pages.scss</a>
  
    <li><a href="../../config_ru.html">config.ru</a>
  
    <li><a href="../../log/development_log.html">development.log</a>
  
    <li><a href="../../node_modules/addressparser/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../node_modules/addressparser/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/addressparser/README_md.html">README</a>
  
    <li><a href="../../node_modules/addressparser/lib/addressparser_js.html">addressparser.js</a>
  
    <li><a href="../../node_modules/addressparser/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_ensureasync/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_ensureasync/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_ensureasync/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_queue/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_queue/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_queue/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_arrayeach/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_arrayeach/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_arrayeach/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_ensureasync/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_ensureasync/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_ensureasync/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_isarray/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_isarray/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_isarray/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_map/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_map/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_map/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_noop/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_noop/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_noop/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_onlyonce/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_onlyonce/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_onlyonce/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_queue/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_queue/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_queue/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_restparam/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_restparam/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_restparam/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/async_util_setimmediate/README_md.html">README</a>
  
    <li><a href="../../node_modules/async_util_setimmediate/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/async_util_setimmediate/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/bottleneck/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/bottleneck/README_md.html">README</a>
  
    <li><a href="../../node_modules/bottleneck/bottleneck_d_ts_ejs.html">bottleneck.d.ts.ejs</a>
  
    <li><a href="../../node_modules/bottleneck/bottleneck_js.html">bottleneck.js</a>
  
    <li><a href="../../node_modules/bottleneck/bottleneck_min_js.html">bottleneck.min.js</a>
  
    <li><a href="../../node_modules/bottleneck/bower_json.html">bower.json</a>
  
    <li><a href="../../node_modules/bottleneck/lib/Bottleneck_js.html">Bottleneck.js</a>
  
    <li><a href="../../node_modules/bottleneck/lib/Cluster_js.html">Cluster.js</a>
  
    <li><a href="../../node_modules/bottleneck/lib/DLList_js.html">DLList.js</a>
  
    <li><a href="../../node_modules/bottleneck/lib/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/bottleneck/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/bottleneck/scripts/build_sh.html">build.sh</a>
  
    <li><a href="../../node_modules/bottleneck/src/Bottleneck_coffee.html">Bottleneck.coffee</a>
  
    <li><a href="../../node_modules/bottleneck/src/Cluster_coffee.html">Cluster.coffee</a>
  
    <li><a href="../../node_modules/bottleneck/src/DLList_coffee.html">DLList.coffee</a>
  
    <li><a href="../../node_modules/bottleneck/src/index_coffee.html">index.coffee</a>
  
    <li><a href="../../node_modules/bottleneck/test_ts.html">test.ts</a>
  
    <li><a href="../../node_modules/bottleneck/test/DLList_js.html">DLList.js</a>
  
    <li><a href="../../node_modules/bottleneck/test/general_js.html">general.js</a>
  
    <li><a href="../../node_modules/bottleneck/test/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/bottleneck/test/priority_js.html">priority.js</a>
  
    <li><a href="../../node_modules/bottleneck/test/promises_js.html">promises.js</a>
  
    <li><a href="../../node_modules/debug/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../node_modules/debug/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/debug/Makefile.html">Makefile</a>
  
    <li><a href="../../node_modules/debug/README_md.html">README</a>
  
    <li><a href="../../node_modules/debug/component_json.html">component.json</a>
  
    <li><a href="../../node_modules/debug/karma_conf_js.html">karma.conf.js</a>
  
    <li><a href="../../node_modules/debug/node_js.html">node.js</a>
  
    <li><a href="../../node_modules/debug/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/debug/src/browser_js.html">browser.js</a>
  
    <li><a href="../../node_modules/debug/src/debug_js.html">debug.js</a>
  
    <li><a href="../../node_modules/debug/src/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/debug/src/node_js.html">node.js</a>
  
    <li><a href="../../node_modules/encoding/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/encoding/README_md.html">README</a>
  
    <li><a href="../../node_modules/encoding/lib/encoding_js.html">encoding.js</a>
  
    <li><a href="../../node_modules/encoding/lib/iconv-loader_js.html">iconv-loader.js</a>
  
    <li><a href="../../node_modules/encoding/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/encoding/test/test_js.html">test.js</a>
  
    <li><a href="../../node_modules/extend/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../node_modules/extend/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/extend/README_md.html">README</a>
  
    <li><a href="../../node_modules/extend/component_json.html">component.json</a>
  
    <li><a href="../../node_modules/extend/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/extend/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/iconv-lite/Changelog_md.html">Changelog</a>
  
    <li><a href="../../node_modules/iconv-lite/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/iconv-lite/README_md.html">README</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/dbcs-codec_js.html">dbcs-codec.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/dbcs-data_js.html">dbcs-data.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/internal_js.html">internal.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/sbcs-codec_js.html">sbcs-codec.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/sbcs-data-generated_js.html">sbcs-data-generated.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/sbcs-data_js.html">sbcs-data.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/big5-added_json.html">big5-added.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/cp936_json.html">cp936.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/cp949_json.html">cp949.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/cp950_json.html">cp950.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/eucjp_json.html">eucjp.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/gb18030-ranges_json.html">gb18030-ranges.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/gbk-added_json.html">gbk-added.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/tables/shiftjis_json.html">shiftjis.json</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/utf16_js.html">utf16.js</a>
  
    <li><a href="../../node_modules/iconv-lite/encodings/utf7_js.html">utf7.js</a>
  
    <li><a href="../../node_modules/iconv-lite/lib/bom-handling_js.html">bom-handling.js</a>
  
    <li><a href="../../node_modules/iconv-lite/lib/extend-node_js.html">extend-node.js</a>
  
    <li><a href="../../node_modules/iconv-lite/lib/index_d_ts.html">index.d.ts</a>
  
    <li><a href="../../node_modules/iconv-lite/lib/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/iconv-lite/lib/streams_js.html">streams.js</a>
  
    <li><a href="../../node_modules/iconv-lite/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/lodash_chunk/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/lodash_chunk/README_md.html">README</a>
  
    <li><a href="../../node_modules/lodash_chunk/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/lodash_chunk/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/mailparser/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/mailparser/README_md.html">README</a>
  
    <li><a href="../../node_modules/mailparser/lib/datetime_js.html">datetime.js</a>
  
    <li><a href="../../node_modules/mailparser/lib/mailparser_js.html">mailparser.js</a>
  
    <li><a href="../../node_modules/mailparser/lib/streams_js.html">streams.js</a>
  
    <li><a href="../../node_modules/mailparser/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/mailparser/test/mailparser_js.html">mailparser.js</a>
  
    <li><a href="../../node_modules/mailparser/test/mixed_eml.html">mixed.eml</a>
  
    <li><a href="../../node_modules/mailparser/test/nested_eml.html">nested.eml</a>
  
    <li><a href="../../node_modules/mime/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/mime/README_md.html">README</a>
  
    <li><a href="../../node_modules/mime/build/build_js.html">build.js</a>
  
    <li><a href="../../node_modules/mime/build/test_js.html">test.js</a>
  
    <li><a href="../../node_modules/mime/cli_js.html">cli.js</a>
  
    <li><a href="../../node_modules/mime/mime_js.html">mime.js</a>
  
    <li><a href="../../node_modules/mime/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/mime/types_json.html">types.json</a>
  
    <li><a href="../../node_modules/mimelib/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/mimelib/README_md.html">README</a>
  
    <li><a href="../../node_modules/mimelib/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/mimelib/lib/content-types-reversed_js.html">content-types-reversed.js</a>
  
    <li><a href="../../node_modules/mimelib/lib/content-types_js.html">content-types.js</a>
  
    <li><a href="../../node_modules/mimelib/lib/mimelib_js.html">mimelib.js</a>
  
    <li><a href="../../node_modules/mimelib/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/ms/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/ms/license_md.html">license</a>
  
    <li><a href="../../node_modules/ms/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/ms/readme_md.html">readme</a>
  
    <li><a href="../../node_modules/sendgrid-rest/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../node_modules/sendgrid-rest/CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="../../node_modules/sendgrid-rest/LICENSE_txt.html">LICENSE</a>
  
    <li><a href="../../node_modules/sendgrid-rest/README_md.html">README</a>
  
    <li><a href="../../node_modules/sendgrid-rest/examples/example_js.html">example.js</a>
  
    <li><a href="../../node_modules/sendgrid-rest/lib/client_js.html">client.js</a>
  
    <li><a href="../../node_modules/sendgrid-rest/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/sendgrid-rest/test/test_js.html">test.js</a>
  
    <li><a href="../../node_modules/sendgrid/CHANGELOG_md.html">CHANGELOG</a>
  
    <li><a href="../../node_modules/sendgrid/CONTRIBUTING_md.html">CONTRIBUTING</a>
  
    <li><a href="../../node_modules/sendgrid/LICENSE_txt.html">LICENSE</a>
  
    <li><a href="../../node_modules/sendgrid/README_md.html">README</a>
  
    <li><a href="../../node_modules/sendgrid/TROUBLESHOOTING_md.html">TROUBLESHOOTING</a>
  
    <li><a href="../../node_modules/sendgrid/USAGE_md.html">USAGE</a>
  
    <li><a href="../../node_modules/sendgrid/USE_CASES_md.html">USE_CASES</a>
  
    <li><a href="../../node_modules/sendgrid/examples/accesssettings/accesssettings_js.html">accesssettings.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/alerts/alerts_js.html">alerts.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/apikeys/apikeys_js.html">apikeys.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/asm/asm_js.html">asm.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/browsers/browsers_js.html">browsers.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/campaigns/campaigns_js.html">campaigns.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/categories/categories_js.html">categories.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/clients/clients_js.html">clients.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/contactdb/contactdb_js.html">contactdb.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/devices/devices_js.html">devices.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/geo/geo_js.html">geo.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/helpers/mail/example_js.html">example.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/ips/ips_js.html">ips.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/mail/mail_js.html">mail.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/mailboxproviders/mailboxproviders_js.html">mailboxproviders.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/mailsettings/mailsettings_js.html">mailsettings.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/partnersettings/partnersettings_js.html">partnersettings.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/scopes/scopes_js.html">scopes.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/senders/senders_js.html">senders.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/stats/stats_js.html">stats.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/subusers/subusers_js.html">subusers.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/suppression/suppression_js.html">suppression.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/templates/templates_js.html">templates.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/trackingsettings/trackingsettings_js.html">trackingsettings.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/user/user_js.html">user.js</a>
  
    <li><a href="../../node_modules/sendgrid/examples/whitelabel/whitelabel_js.html">whitelabel.js</a>
  
    <li><a href="../../node_modules/sendgrid/index_d_ts.html">index.d.ts</a>
  
    <li><a href="../../node_modules/sendgrid/index_js.html">index.js</a>
  
    <li><a href="../../node_modules/sendgrid/lib/helpers/contact-importer/contact-importer_js.html">contact-importer.js</a>
  
    <li><a href="../../node_modules/sendgrid/lib/helpers/error_js.html">error.js</a>
  
    <li><a href="../../node_modules/sendgrid/lib/helpers/inbound/parse_js.html">parse.js</a>
  
    <li><a href="../../node_modules/sendgrid/lib/helpers/mail/README_md.html">README</a>
  
    <li><a href="../../node_modules/sendgrid/lib/helpers/mail/mail_js.html">mail.js</a>
  
    <li><a href="../../node_modules/sendgrid/lib/sendgrid_js.html">sendgrid.js</a>
  
    <li><a href="../../node_modules/sendgrid/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/sendgrid/test/helpers/contact-importer/contact-importer_test_js.html">contact-importer.test.js</a>
  
    <li><a href="../../node_modules/sendgrid/test/helpers/inbound/parse_test_js.html">parse.test.js</a>
  
    <li><a href="../../node_modules/sendgrid/test/helpers/mail/test_js.html">test.js</a>
  
    <li><a href="../../node_modules/sendgrid/test/prism_sh.html">prism.sh</a>
  
    <li><a href="../../node_modules/sendgrid/test/test_js.html">test.js</a>
  
    <li><a href="../../node_modules/sendgrid/tsconfig_json.html">tsconfig.json</a>
  
    <li><a href="../../node_modules/uue/LICENSE.html">LICENSE</a>
  
    <li><a href="../../node_modules/uue/README_md.html">README</a>
  
    <li><a href="../../node_modules/uue/package_json.html">package.json</a>
  
    <li><a href="../../node_modules/uue/uue_js.html">uue.js</a>
  
    <li><a href="../../package-lock_json.html">package-lock.json</a>
  
    <li><a href="../../package_json.html">package.json</a>
  
    <li><a href="../../public/404_html.html">404.html</a>
  
    <li><a href="../../public/422_html.html">422.html</a>
  
    <li><a href="../../public/500_html.html">500.html</a>
  
    <li><a href="../../public/apple-touch-icon-precomposed_png.html">apple-touch-icon-precomposed.png</a>
  
    <li><a href="../../public/apple-touch-icon_png.html">apple-touch-icon.png</a>
  
    <li><a href="../../public/favicon_ico.html">favicon.ico</a>
  
    <li><a href="../../public/robots_txt.html">robots</a>
  
    <li><a href="../../tmp/pids/server_pid.html">server.pid</a>
  
    <li><a href="../../tmp/restart_txt.html">restart</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page node_modules/uue/uue.js">

<p>var fs = require(&#39;fs&#39;); var path = require(&#39;path&#39;); var
extend = require(&#39;extend&#39;);</p>

<p>var UUE = function(){</p>

<pre>if (!(this instanceof UUE)) return new UUE();</pre>

<p>};</p>

<p>UUE.prototype.encode = function(encodeSource, encodeOptions){</p>

<pre>   jshint bitwise:false   
var options = extend(
   {},
   { mode: null, filename: null, eol: null },
   encodeOptions
);

if( typeof encodeSource === &#39;string&#39; ){ // treat as filename
   // check options.mode
   if( options.mode === null ){
      options.mode = (
         fs.statSync(encodeSource).mode &amp; parseInt(&#39;777&#39;, 8)
      ).toString(8);
   } else if( typeof options.mode !== &#39;string&#39; ){
      options.mode = options.mode.toString(8);
   }

   // check options.filename
   if( options.filename === null ){
      options.filename = path.basename(encodeSource);
   }

   // make encodeSource a buffer
   encodeSource = fs.readFileSync(encodeSource);
} else if( Buffer.isBuffer(encodeSource) ){ // treat as buffer
   // check options.mode
   if( options.mode === null ){
      options.mode = &#39;644&#39;;
   } else if( typeof options.mode !== &#39;string&#39; ){
      options.mode = options.mode.toString(8);
   }

   // check options.filename
   if( options.filename === null ) options.filename = &#39;buffer.bin&#39;;
} else throw new Error(this.errors.UNKNOWN_SOURCE_TYPE);

if( options.eol === null ) options.eol = &#39;\n&#39;;

// now encodeSource is always a buffer
var output = [];
output.push(&#39;begin &#39;);
output.push(options.mode);
output.push(&#39; &#39;);
output.push(options.filename);
output.push(options.eol);

var offset = 0;
while( offset &lt; encodeSource.length ){
   var triplet, total, charCode;
   if( encodeSource.length - offset &gt;= 45 ){ // complete line, 15 triplets
      output.push(String.fromCharCode(45 + 32));
      for( triplet = 0; triplet &lt; 15; triplet++ ){
         total = 0;

         total += encodeSource.readUInt8(offset) &lt;&lt; 16;
         offset++;
         total += encodeSource.readUInt8(offset) &lt;&lt; 8;
         offset++;
         total += encodeSource.readUInt8(offset);
         offset++;

         charCode = total &gt;&gt;&gt; 18;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 12) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 6) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = total &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));
      }
   } else { // last line, less than 15 triplets
      output.push(String.fromCharCode(encodeSource.length - offset + 32));
      var tripletNum = ( (encodeSource.length - offset) /3 ) |0;
      for( triplet = 0; triplet &lt; tripletNum; triplet++ ){
         total = 0;

         total += encodeSource.readUInt8(offset) &lt;&lt; 16;
         offset++;
         total += encodeSource.readUInt8(offset) &lt;&lt; 8;
         offset++;
         total += encodeSource.readUInt8(offset);
         offset++;

         charCode = total &gt;&gt;&gt; 18;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 12) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 6) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = total &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));
      }
      if( offset &lt; encodeSource.length ){ // some bytes remain
         total = 0;

         total += encodeSource.readUInt8(offset) &lt;&lt; 16;
         offset++;
         if( offset &lt; encodeSource.length ){
            total += encodeSource.readUInt8(offset) &lt;&lt; 8;
            offset++;
         }
         if( offset &lt; encodeSource.length ){
            total += encodeSource.readUInt8(offset);
            offset++;
         }

         charCode = total &gt;&gt;&gt; 18;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 12) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = (total &gt;&gt;&gt; 6) &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));

         charCode = total &amp; 0x3F;
         if( charCode === 0 ) charCode = 64;
         output.push(String.fromCharCode(charCode + 32));
      }
   }
   output.push(options.eol);
}

output.push(&#39;`&#39;);
output.push(options.eol);
output.push(&#39;end&#39;);
return output.join(&#39;&#39;);</pre>

<p>};</p>

<p>UUE.prototype.decodeFile = function(text, filename){</p>

<pre>var matches = [];
var potentialUUE = RegExp(
   [
      &#39;^begin [0-7]{3} &#39; + filename + &#39;\n&#39;,
      &#39;(&#39;,
      &#39;(?:[\x20-\x60]+\n)*&#39;, // allow garbage after significant characters
      &#39;)&#39;,
      &#39;(?:`| )\n&#39;,
      &#39;end$&#39;
   ].join(&#39;&#39;),
   &#39;gm&#39;
);

var continueSearch = true;
do {
   var nextMatch = potentialUUE.exec(text);
   if( nextMatch === null ){
      continueSearch = false;
   } else {
      matches.push(nextMatch);
   }
} while( continueSearch );

if( matches.length === 0 ) return null;

var fileFound = null;
matches.forEach(function(nextMatch){
   if( fileFound !== null ) return;

   if( nextMatch[1].length &lt; 1 ){
      fileFound = new Buffer(0);
      return;
   }

   var decodingError = false;
   var decoded = nextMatch[1].split(&#39;\n&#39;);
   decoded.pop(); // cut last \n (it is not a separator)
   decoded = decoded.map(function(lineUUE){
         jshint bitwise:false   
      if( decodingError ) return null;

      var byteLength = (lineUUE.charCodeAt(0) - 32) % 64;
      if( byteLength === 0 ) return new Buffer(0);

      var charLength = ( (byteLength / 3) |0 ) * 4;
      if( byteLength % 3 !== 0 ) charLength += 4;
      if( 1 + charLength &gt; lineUUE.length ){
         decodingError = true;
         return null;
      }
      var targetBuffer = new Buffer(byteLength);

      var step, total;
      var stringOffset = 1;
      var bufferOffset = 0;
      for( step = 0; step &lt; ( (charLength / 4) |0 ); step++ ){
         total = 0;

         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 18;
         stringOffset++;
         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 12;
         stringOffset++;
         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 6;
         stringOffset++;
         total +=  (lineUUE.charCodeAt(stringOffset) - 32) % 64;
         stringOffset++;

         // noAssert === true:
         // silently apply &amp;0xFF mask, silently drop after byteLength
         targetBuffer.writeUInt8( total &gt;&gt;&gt; 16, bufferOffset, true );
         bufferOffset++;
         targetBuffer.writeUInt8( total &gt;&gt;&gt; 8, bufferOffset, true );
         bufferOffset++;
         targetBuffer.writeUInt8( total, bufferOffset, true );
         bufferOffset++;
      }
      return targetBuffer;
   });
   if( decodingError ) return;

   // now `decoded` is a valid array containing buffers,
   // because `null` could appear only in `decodingError` state
   fileFound = Buffer.concat(decoded);
});

return fileFound;</pre>

<p>};</p>

<p>UUE.prototype.decodeAllFiles = function(text){</p>

<pre>var allFiles = [];
var matches = [];
var potentialUUE = RegExp(
   [ // detail-capturing version of the RegExp from `.split`
      &#39;^begin [0-7]{3} (\\S(?:.*?\\S)?)\n&#39;,
      &#39;(&#39;,
      &#39;(?:[\x20-\x60]+\n)*&#39;, // allow garbage after significant characters
      &#39;)&#39;,
      &#39;(?:`| )\n&#39;,
      &#39;end$&#39;
   ].join(&#39;&#39;),
   &#39;gm&#39;
);

var continueSearch = true;
do {
   var nextMatch = potentialUUE.exec(text);
   if( nextMatch === null ){
      continueSearch = false;
   } else {
      matches.push(nextMatch);
   }
} while( continueSearch );

if( matches.length === 0 ) return [];

matches.forEach(function(nextMatch){
   var nextFilename = nextMatch[1];
   var idxFilename = allFiles.findIndex(function(nextFile){
      return nextFile.name === nextFilename;
   });
   if( idxFilename &gt; -1 ) return; // already found, skip it

   if( nextMatch[2].length &lt; 1 ){
      allFiles.push({
         name: nextFilename,
         data: new Buffer(0)
      });
      return;
   }

   var decodingError = false;
   var decoded = nextMatch[2].split(&#39;\n&#39;);
   decoded.pop(); // cut last \n (it is not a separator)
   decoded = decoded.map(function(lineUUE){
      /* jshint bitwise:false */
      if( decodingError ) return null;

      var byteLength = (lineUUE.charCodeAt(0) - 32) % 64;
      if( byteLength === 0 ) return new Buffer(0);

      var charLength = ( (byteLength / 3) |0 ) * 4;
      if( byteLength % 3 !== 0 ) charLength += 4;
      if( 1 + charLength &gt; lineUUE.length ){
         decodingError = true;
         return null;
      }
      var targetBuffer = new Buffer(byteLength);

      var step, total;
      var stringOffset = 1;
      var bufferOffset = 0;
      for( step = 0; step &lt; ( (charLength / 4) |0 ); step++ ){
         total = 0;

         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 18;
         stringOffset++;
         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 12;
         stringOffset++;
         total += ((lineUUE.charCodeAt(stringOffset) - 32) % 64) &lt;&lt; 6;
         stringOffset++;
         total +=  (lineUUE.charCodeAt(stringOffset) - 32) % 64;
         stringOffset++;

         // noAssert === true:
         // silently apply &amp;0xFF mask, silently drop after byteLength
         targetBuffer.writeUInt8( total &gt;&gt;&gt; 16, bufferOffset, true );
         bufferOffset++;
         targetBuffer.writeUInt8( total &gt;&gt;&gt; 8, bufferOffset, true );
         bufferOffset++;
         targetBuffer.writeUInt8( total, bufferOffset, true );
         bufferOffset++;
      }
      return targetBuffer;
   });
   if( decodingError ) return;

   // now `decoded` is a valid array containing buffers,
   // because `null` could appear only in `decodingError` state
   allFiles.push({
      name: nextFilename,
      data: Buffer.concat(decoded)
   });
});

return allFiles;</pre>

<p>};</p>

<p>UUE.prototype.split = function(text){</p>

<pre>var processUUE = this;
var potentialUUE = RegExp(
   [ // entirely-capturing version of the RegExp from `.decodeAllFiles`
      &#39;(&#39;,
      &#39;^begin [0-7]{3} \\S(?:.*?\\S)?\n&#39;,
      &#39;(?:[\x20-\x60]+\n)*&#39;, // allow garbage after significant characters
      &#39;(?:`| )\n&#39;,
      &#39;end$&#39;,
      &#39;)&#39;
   ].join(&#39;&#39;),
   &#39;gm&#39;
);
return text.split(potentialUUE).map(function(fragment, idx, arr){
   /* jshint indent: false */
   if( idx % 2 === 0 ){ // simple string fragment&#39;s index: 0, 2, 4...
      return fragment;
   } else { // regex-captured fragment&#39;s index: 1, 3, 5...
      var decodedFiles = processUUE.decodeAllFiles(fragment);
      switch( decodedFiles.length ){
         case 0:
            // incorrect UUE, append to the previous (always text) fragment
            arr[idx-1] += fragment;
            return null;
         //break;
         case 1:
            // correct UUE
            decodedFiles[0].source = fragment;
            decodedFiles[0].type = &#39;UUE&#39;;
            return decodedFiles[0];
         //break;
         default: throw new Error(
            processUUE.errors.UNEXPECTED_NUMBER_OF_FILES
         );
      }
   }
}).filter(function(nextElement){
   if( nextElement === &#39;&#39; ) return false;
   if( nextElement === null ) return false;

   return true;
}).reduce(function(builtArray, nextFragment){
   if( typeof nextFragment !== &#39;string&#39; ){
      builtArray.push(nextFragment);
   } else { // typeof nextFragment === &#39;string&#39;
      if(
         builtArray.length &gt; 0 &amp;&amp;
         typeof builtArray[builtArray.length - 1] === &#39;string&#39;
      ){ // the array&#39;s last element is also a string; appending:
         builtArray[builtArray.length - 1] += nextFragment;
      } else {
         builtArray.push(nextFragment);
      }
   }
   return builtArray;
}, []);</pre>

<p>};</p>

<p>UUE.prototype.errors = {</p>

<pre>UNKNOWN_SOURCE_TYPE: &quot;The source&#39;s type is unknown!&quot;,
UNEXPECTED_NUMBER_OF_FILES: &quot;Unexpected number of files in a fragment!&quot;</pre>

<p>};</p>

<p>module.exports = new UUE();</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

